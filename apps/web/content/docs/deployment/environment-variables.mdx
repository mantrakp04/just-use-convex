---
title: Production Environment Variables
description: Managing environment variables across all deployment components
---

# Production Environment Variables

This application has three deployment components, each with its own set of environment variables. All variables are validated at runtime using `@t3-oss/env-core` with Zod schemas.

## Frontend (`apps/web/.env`)

Variables prefixed with `VITE_` are exposed to the client bundle.

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `VITE_CONVEX_URL` | Yes | -- | Convex deployment URL (e.g., `https://<slug>.convex.cloud`) |
| `VITE_CONVEX_SITE_URL` | Yes | -- | Convex site URL for HTTP actions (e.g., `https://<slug>.convex.site`) |
| `VITE_AGENT_URL` | No | `http://localhost:1337` | Cloudflare Workers agent URL |

```bash
# apps/web/.env
VITE_CONVEX_URL=https://your-deployment.convex.cloud
VITE_CONVEX_SITE_URL=https://your-deployment.convex.site
VITE_AGENT_URL=https://your-agent.your-domain.workers.dev
```

<Callout type="error">
Never prefix secrets with `VITE_` -- this exposes them to clients.
</Callout>

## Convex Backend (Convex Dashboard Environment Variables)

Set these via the Convex dashboard or CLI. These are server-side only.

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `AGENT_URL` | No | `http://localhost:1337` | Agent endpoint URL |
| `DAYTONA_API_KEY` | No | -- | Daytona API key for sandbox provisioning |
| `DAYTONA_API_URL` | No | `https://app.daytona.io/api` | Daytona API endpoint |
| `DAYTONA_TARGET` | No | `us` | Daytona region target |
| `EXTERNAL_TOKEN` | No | `meow` | Shared token for agent-to-Convex auth |
| `JWKS` | No | -- | JSON Web Key Set for JWT verification |
| `SITE_URL` | No | `http://localhost:3001` | Frontend URL (for callbacks, CORS) |

```bash
# Set via CLI
bunx convex env set AGENT_URL "https://your-agent.workers.dev"
bunx convex env set EXTERNAL_TOKEN "your-secure-token"
bunx convex env set JWKS '{"keys":[...]}'
bunx convex env set SITE_URL "https://yourapp.com"

# Optional: Daytona sandbox support
bunx convex env set DAYTONA_API_KEY "your-daytona-key"
bunx convex env set DAYTONA_API_URL "https://app.daytona.io/api"
bunx convex env set DAYTONA_TARGET "us"
```

## Agent (`packages/agent/.dev.vars` or Alchemy Secrets)

The agent runs on Cloudflare Workers. In development, use `.dev.vars`. In production, secrets are managed via Alchemy or the Cloudflare dashboard.

| Variable | Required | Default | Description |
|----------|----------|---------|-------------|
| `OPENROUTER_API_KEY` | Yes | -- | OpenRouter API key for AI model access |
| `CONVEX_URL` | Yes | -- | Convex deployment URL |
| `CONVEX_SITE_URL` | Yes | -- | Convex site URL |
| `SITE_URL` | No | `http://localhost:3001` | Frontend URL |
| `EXTERNAL_TOKEN` | No | `meow` | Shared token for Convex auth (must match backend) |
| `DEFAULT_MODEL` | No | `openai/gpt-5.2-chat` | Default AI model slug |
| `MAX_BACKGROUND_DURATION_MS` | No | `3600000` | Max background task duration (ms) |
| `DAYTONA_API_KEY` | No | -- | Daytona API key for sandbox operations |
| `DAYTONA_API_URL` | No | `https://app.daytona.io/api` | Daytona API endpoint |
| `DAYTONA_TARGET` | No | `us` | Daytona region target |
| `EXA_API_KEY` | No | -- | Exa API key for web search tool |
| `COMPOSIO_API_KEY` | No | -- | Composio API key for tool integrations |
| `VOLTAGENT_PUBLIC_KEY` | No | -- | VoltAgent observability public key |
| `VOLTAGENT_SECRET_KEY` | No | -- | VoltAgent observability secret key |
| `ALCHEMY_PASSWORD` | No | -- | Alchemy deployment password |

```bash
# packages/agent/.dev.vars (local development)
OPENROUTER_API_KEY=sk-or-xxxxx
CONVEX_URL=https://your-deployment.convex.cloud
CONVEX_SITE_URL=https://your-deployment.convex.site
SITE_URL=http://localhost:3001
EXTERNAL_TOKEN=meow
DEFAULT_MODEL=openai/gpt-5.2-chat
EXA_API_KEY=your-exa-key
DAYTONA_API_KEY=your-daytona-key
```

## Setting Variables by Platform

### Vercel (Frontend)

```bash
# Add variables
vercel env add VITE_CONVEX_URL production
vercel env add VITE_AGENT_URL production

# List variables
vercel env ls
```

### Convex Dashboard (Backend)

1. Open your project at [dashboard.convex.dev](https://dashboard.convex.dev)
2. Go to Settings -> Environment Variables
3. Add each variable

Or via CLI:

```bash
bunx convex env set VARIABLE_NAME "value"
bunx convex env list
```

### Cloudflare (Agent)

For production, set secrets via Alchemy config or the Cloudflare dashboard:

```bash
# Via wrangler (if not using Alchemy)
wrangler secret put OPENROUTER_API_KEY
wrangler secret put CONVEX_URL
wrangler secret put EXTERNAL_TOKEN
```

## Shared Secrets

The `EXTERNAL_TOKEN` must match between the Convex backend and the agent. This token authenticates agent-to-Convex communication.

The `DAYTONA_API_KEY`, `DAYTONA_API_URL`, and `DAYTONA_TARGET` values should be consistent across the backend and agent if you want sandbox support.

## Validation

All environment variables are validated at startup using `@t3-oss/env-core` with Zod schemas defined in the `@just-use-convex/env` package:

```
packages/env/src/
├── web.ts      # Frontend variables (VITE_ prefixed)
├── backend.ts  # Convex backend variables
└── agent.ts    # Agent variables
```

Missing required variables will throw immediately at startup, preventing silent failures.

## OAuth Callback URLs

Configure callback URLs for each environment:

```
# Development
http://localhost:3001/api/auth/callback/github
http://localhost:3001/api/auth/callback/google

# Production
https://yourapp.com/api/auth/callback/github
https://yourapp.com/api/auth/callback/google
```

## Debugging

```bash
# Check Convex env vars
bunx convex env list

# Check Vercel env vars
vercel env ls

# Verify frontend vars are loaded (in browser console)
console.log(import.meta.env.VITE_CONVEX_URL)
```

### Common Issues

**Variable not available in client:**
- Ensure it is prefixed with `VITE_`
- Rebuild after adding the variable
- Check that it is set for the correct environment

**Agent cannot reach Convex:**
- Verify `CONVEX_URL` and `CONVEX_SITE_URL` are set in agent secrets
- Verify `EXTERNAL_TOKEN` matches between agent and Convex backend

**Sandbox not working:**
- Verify `DAYTONA_API_KEY` is set in both Convex backend and agent
- Check `DAYTONA_API_URL` and `DAYTONA_TARGET` are consistent

**OAuth callback errors:**
- Verify callback URL matches exactly (including protocol and port)
- Ensure HTTPS in production

## Next Steps

Review the [deployment overview](/docs/deployment/overview) for the complete deployment checklist.
